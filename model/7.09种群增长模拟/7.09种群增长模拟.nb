(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     15247,        361]
NotebookOptionsPosition[     14837,        343]
NotebookOutlinePosition[     15347,        363]
CellTagsIndexPosition[     15304,        360]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{"Needs", "[", "\"\<ANOVA`\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"source", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\"\<Time/h\>\"", ",", "0.`", ",", "2.`", ",", "4.`", ",", "6.`", ",", 
       "8.`", ",", "10.`", ",", "13.`", ",", "16.`", ",", "19.`", ",", 
       "22.5`", ",", "26.`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "\"\<GR286\>\"", ",", "0.03783333333333334`", ",", "0.3275`", ",", 
       "0.9674499999999999`", ",", "2.119`", ",", "2.9915000000000003`", ",", 
       "3.3375`", ",", "3.57375`", ",", "3.8965`", ",", "3.28125`", ",", 
       "2.15375`", ",", "2.04225`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "\"\<C2-luxS\>\"", ",", "0.016333333333333335`", ",", 
       "0.05223333333333333`", ",", "0.16666666666666666`", ",", "0.333767`", 
       ",", "0.9956666666666665`", ",", "1.597333333333333`", ",", "2.0845`", 
       ",", "2.3753333333333333`", ",", "1.92025`", ",", "1.187`", ",", 
       "0.96025`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "\"\<YD-luxS\>\"", ",", "0.055233333333333336`", ",", 
       "0.22865000000000002`", ",", "0.5602`", ",", "1.3381666666666667`", 
       ",", "2.306`", ",", "2.6361666666666665`", ",", "2.7071666666666667`", 
       ",", "2.4705`", ",", "2.368666666666667`", ",", "1.4009999999999998`", 
       ",", "1.0955000000000001`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "\"\<YD-luxS+xyl\>\"", ",", "0.0501`", ",", "0.18306666666666668`", ",",
        "0.4393666666666667`", ",", "1.1564999999999999`", ",", 
       "2.1166666666666667`", ",", "2.650166666666667`", ",", 
       "3.063166666666666`", ",", "3.112166666666667`", ",", 
       "2.723166666666667`", ",", "2.2545`", ",", "2.461`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "\"\<PWH\>\"", ",", "0.042866666666666664`", ",", 
       "0.19766666666666666`", ",", "0.5158999999999999`", ",", 
       "1.5001666666666666`", ",", "2.195666666666667`", ",", 
       "2.5976666666666666`", ",", "2.5148333333333333`", ",", 
       "2.5420000000000003`", ",", "2.3125`", ",", "1.1133333333333333`", ",",
        "1.12775`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "\"\<\[EmptyUpTriangle]luxS\>\"", ",", "0.06943333333333333`", ",", 
       "0.20265`", ",", "0.6750499999999999`", ",", "1.8042500000000001`", 
       ",", "2.759`", ",", "3.18225`", ",", "3.418`", ",", "3.6315`", ",", 
       "3.2807500000000003`", ",", "1.79025`", ",", "1.93825`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "\"\<PHT01\>\"", ",", "0.059`", ",", "0.09596666666666666`", ",", 
       "0.28163333333333335`", ",", "0.8581666666666666`", ",", 
       "1.940833333333333`", ",", "2.6438333333333337`", ",", 
       "3.1558333333333333`", ",", "3.231`", ",", "2.841833333333334`", ",", 
       "0.9098333333333335`", ",", "0.9667500000000001`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "\"\<ACDB\>\"", ",", "0.044433333333333346`", ",", 
       "0.11033333333333334`", ",", "0.3852666666666667`", ",", "1.1895`", 
       ",", "2.226166666666667`", ",", "2.770833333333333`", ",", 
       "3.0434999999999994`", ",", "3.250166666666667`", ",", 
       "3.036666666666667`", ",", "1.6626666666666667`", ",", 
       "1.697833333333333`"}], "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FormatData", "[", 
   RowBox[{
    RowBox[{"i_:", "1"}], ",", 
    RowBox[{"j_:", "1"}]}], "]"}], ":=", 
  RowBox[{"Transpose", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"source", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", 
        RowBox[{"2", ";;", 
         RowBox[{"-", "j"}]}]}], "]"}], "]"}], ",", 
     RowBox[{"source", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"i", "+", "1"}], ",", 
        RowBox[{"2", ";;", 
         RowBox[{"-", "j"}]}]}], "]"}], "]"}]}], "}"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"LogisticModel", "[", "data_", "]"}], ":=", 
  RowBox[{"NonlinearModelFit", "[", 
   RowBox[{"data", ",", 
    FractionBox["\[FormalK]", 
     RowBox[{"1", "+", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"\[FormalA]", "-", 
        RowBox[{"\[FormalR]", "*", "\[FormalT]"}]}]]}]], ",", 
    RowBox[{"{", 
     RowBox[{"\[FormalA]", ",", "\[FormalR]", ",", "\[FormalK]"}], "}"}], ",",
     "\[FormalT]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"LogisticParameter", "[", "data_", "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"LogisticModel", "[", "data", "]"}], "[", 
    "\"\<BestFitParameters\>\"", "]"}], "[", 
   RowBox[{"[", 
    RowBox[{"All", ",", "2"}], "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"plot", "[", 
   RowBox[{"data_", ",", "name_"}], "]"}], ":=", 
  RowBox[{"Block", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "model", ",", "function", ",", "label", ",", "xrange", ",", "yrange", 
      ",", "lp", ",", "fp", ",", "g"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"model", "=", 
      RowBox[{"LogisticModel", "[", 
       RowBox[{"data", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"1", ";;", 
           RowBox[{"-", "3"}]}], ",", "All"}], "]"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"function", "=", 
      RowBox[{"Normal", "[", "model", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"label", "=", 
      RowBox[{
      "name", "<>", "\"\<\\t\>\"", "<>", 
       "\"\<\!\(\*SuperscriptBox[\(R\), \(2\)]\)=\>\"", "<>", 
       RowBox[{"ToString", "[", 
        RowBox[{"model", "[", "\"\<RSquared\>\"", "]"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"lp", "=", 
      RowBox[{"ListPlot", "[", "data", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"fp", "=", 
      RowBox[{"Plot", "[", 
       RowBox[{"function", ",", 
        RowBox[{"{", 
         RowBox[{"\[FormalT]", ",", "0", ",", 
          RowBox[{
           RowBox[{"Max", "[", 
            RowBox[{"data", "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}], "*", "1.25"}]}],
          "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Show", "[", 
      RowBox[{"lp", ",", "fp", ",", 
       RowBox[{"AxesLabel", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Style", "[", 
           RowBox[{"\"\<\:57f9\:517b\:65f6\:95f4/h\>\"", ",", "Large"}], 
           "]"}], ",", 
          RowBox[{"Style", "[", 
           RowBox[{"\"\<\:79cd\:7fa4\:6570\:91cf\>\"", ",", "Large"}], 
           "]"}]}], "}"}]}], ",", 
       RowBox[{"PlotLabel", "\[Rule]", 
        RowBox[{"Style", "[", 
         RowBox[{"label", ",", "40"}], "]"}]}], ",", 
       RowBox[{"ImageSize", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"1080", ",", "720"}], "}"}]}], ",", 
       RowBox[{"AxesStyle", "\[Rule]", "Large"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"names", "=", 
    RowBox[{"source", "[", 
     RowBox[{"[", 
      RowBox[{
       RowBox[{"2", ";;", 
        RowBox[{"-", "1"}]}], ",", "1"}], "]"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"n", "=", "4"}], ",", "Rsquare"}], "}"}], ",", 
      RowBox[{
       RowBox[{"Rsquare", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"LogisticModel", "[", 
              RowBox[{"FormatData", "[", 
               RowBox[{"i", ",", "j"}], "]"}], "]"}], "[", "\"\<RSquared\>\"",
              "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "8"}], "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "n"}], "}"}]}], "]"}]}], ";", 
       RowBox[{"ANOVA", "[", 
        RowBox[{
         RowBox[{"Flatten", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"i", "-", "1"}], ",", "#"}], "}"}], "&"}], "/@", 
              RowBox[{"Rsquare", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "n"}], "}"}]}], "]"}], ",", "1"}], "]"}], ",", 
         RowBox[{"PostTests", "\[Rule]", "Tukey"}]}], "]"}]}]}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"LogisticParameter", "[", 
         RowBox[{"FormatData", "[", 
          RowBox[{"i", ",", "3"}], "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "8"}], "}"}]}], "]"}]}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"LogisticModel", "[", 
          RowBox[{"FormatData", "[", 
           RowBox[{"i", ",", "3"}], "]"}], "]"}], "[", "\"\<RSquared\>\"", 
         "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "8"}], "}"}]}], "]"}]}], "]"}], ";"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"ListPlot", "[", 
       RowBox[{
        RowBox[{"FormatData", "[", 
         RowBox[{"i", ",", "1"}], "]"}], ",", 
        RowBox[{"PlotLabel", "\[Rule]", 
         RowBox[{"Style", "[", 
          RowBox[{
           RowBox[{"names", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", "60"}], "]"}]}], ",", 
        RowBox[{"AxesStyle", "\[Rule]", "Large"}], ",", 
        RowBox[{"ImageSize", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"1080", ",", "720"}], "}"}]}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "8"}], "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"GraphicsGrid", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"table", "[", 
        RowBox[{"[", 
         RowBox[{"1", ";;", "3"}], "]"}], "]"}], ",", 
       RowBox[{"table", "[", 
        RowBox[{"[", 
         RowBox[{"4", ";;", "6"}], "]"}], "]"}], ",", 
       RowBox[{"table", "[", 
        RowBox[{"[", 
         RowBox[{"7", ";;", "8"}], "]"}], "]"}]}], "}"}], "]"}]}], 
   "*)"}]}]}], "Input",
 CellChangeTimes->{{3.6770613723669553`*^9, 3.677061373914632*^9}, {
   3.677061429531359*^9, 3.677061523371385*^9}, {3.677061612044372*^9, 
   3.677061635734999*^9}, {3.6770617007137156`*^9, 3.6770617272911196`*^9}, {
   3.677062418808638*^9, 3.677062539529975*^9}, {3.67706258912131*^9, 
   3.677062805240775*^9}, {3.6770636040980005`*^9, 3.6770636687220306`*^9}, {
   3.6770637005667677`*^9, 3.6770637198119974`*^9}, {3.677063854200673*^9, 
   3.67706385573405*^9}, {3.6770638943513985`*^9, 3.6770639200380754`*^9}, {
   3.6770643612724953`*^9, 3.6770643657344255`*^9}, {3.6770644413336897`*^9, 
   3.6770644878038406`*^9}, {3.677064883699972*^9, 3.6770649292388897`*^9}, {
   3.6770650454814835`*^9, 3.677065074961671*^9}, {3.677065110315914*^9, 
   3.677065150568817*^9}, {3.677065226839326*^9, 3.677065388397721*^9}, {
   3.677065445322198*^9, 3.6770654663125362`*^9}, {3.6770655028363237`*^9, 
   3.677065620276406*^9}, {3.6770656599863443`*^9, 3.6770656638541975`*^9}, {
   3.6770656979297724`*^9, 3.6770657879775295`*^9}, {3.677065837349622*^9, 
   3.677065880230311*^9}, {3.6770659841234694`*^9, 3.6770660195866823`*^9}, {
   3.677066166084288*^9, 3.6770662329166765`*^9}, {3.6770666733200827`*^9, 
   3.6770667012207375`*^9}, {3.677102868406612*^9, 3.6771028888012686`*^9}, {
   3.6771029309267883`*^9, 3.6771030300864897`*^9}, {3.6771030631333656`*^9, 
   3.677103102514445*^9}, {3.677103195261551*^9, 3.6771032203739047`*^9}, {
   3.677103276418789*^9, 3.677103354284675*^9}, {3.677103412272523*^9, 
   3.677103575002841*^9}, 3.677103753360055*^9, {3.677103795697818*^9, 
   3.6771038758028975`*^9}, {3.6771039234783688`*^9, 
   3.6771039544160953`*^9}, {3.677104292814406*^9, 3.6771043251599064`*^9}, {
   3.677104356774691*^9, 3.6771043597428493`*^9}, {3.6771044571915913`*^9, 
   3.677104550845132*^9}, {3.6771045974139605`*^9, 3.677104617976554*^9}, {
   3.677104756652663*^9, 3.677104770403818*^9}, {3.6771059814651814`*^9, 
   3.677105986902566*^9}, {3.6771069466640663`*^9, 3.677107035061534*^9}, {
   3.6771070691669254`*^9, 3.677107155039319*^9}, {3.677107245156473*^9, 
   3.6771072683313475`*^9}, {3.6771073673454027`*^9, 3.677107417047114*^9}, {
   3.6771075932756696`*^9, 3.6771076059314103`*^9}, {3.677107855649234*^9, 
   3.677107855864621*^9}, {3.6771930971587415`*^9, 3.67719311647657*^9}, {
   3.677193179938764*^9, 3.677193362868202*^9}, {3.6771934060577917`*^9, 
   3.6771935010079365`*^9}, {3.677193808583719*^9, 3.677193935563423*^9}, {
   3.6771939878104115`*^9, 3.677194128086425*^9}, {3.677194264991172*^9, 
   3.677194289401308*^9}, {3.677194319536392*^9, 3.6771943516169915`*^9}, {
   3.6771946231251125`*^9, 3.677194891350312*^9}, {3.67719494831842*^9, 
   3.6771949517194557`*^9}, {3.677195034700065*^9, 3.6771950438517647`*^9}, {
   3.6771950952279377`*^9, 3.6771951512540436`*^9}, {3.677195196188649*^9, 
   3.677195198572261*^9}, {3.6771952560362725`*^9, 3.67719536293111*^9}, {
   3.6771954259786654`*^9, 3.677195473177844*^9}, {3.677195541732584*^9, 
   3.677195595459323*^9}, {3.677195626735877*^9, 3.677195748720586*^9}, {
   3.6772130401889825`*^9, 3.677213124393811*^9}, {3.6772131785034747`*^9, 
   3.6772131792042127`*^9}, {3.6772133365961404`*^9, 3.677213420739064*^9}, {
   3.677213495878964*^9, 3.6772135211071835`*^9}, {3.677213614694582*^9, 
   3.6772136319948535`*^9}, 3.6772136678851347`*^9, {3.6772137086247807`*^9, 
   3.677213840813888*^9}, {3.6772138875755973`*^9, 3.6772139000853963`*^9}, {
   3.677213935172264*^9, 3.6772139392279634`*^9}, {3.677213981100294*^9, 
   3.6772142563201447`*^9}, {3.677214293820591*^9, 3.677214345401458*^9}, {
   3.6772145122715373`*^9, 3.677214601703417*^9}, {3.6772146398674173`*^9, 
   3.677214644098633*^9}, {3.6772147211870885`*^9, 3.6772147844703183`*^9}, {
   3.6772148741296306`*^9, 3.67721487518309*^9}}]
},
WindowSize->{1664, 977},
WindowMargins->{{-8, Automatic}, {Automatic, 0}},
PrintingCopies->1,
PrintingPageRange->{32000, 32000},
PrintingOptions->{"Magnification"->1.,
"PaperOrientation"->"Portrait",
"PaperSize"->{595.1999999999999, 841.8}},
FrontEndVersion->"10.4 for Microsoft Windows (64-bit) (April 17, 2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 14275, 321, 687, "Input"]
}
]
*)

